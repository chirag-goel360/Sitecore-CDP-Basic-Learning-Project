<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Sitecore CDP Project</title>
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/Custom.css" rel="stylesheet" />
    <link href="~/Content/font-awesome.min.css" rel="stylesheet" />
    <link href="~/Content/owl.carousel.css" rel="stylesheet" />
    <link href="~/Content/owl.theme.default.min.css" rel="stylesheet" />
    <script type="text/javascript">
        // Define the Boxever JavaScript Library
        // Define the Boxever queue
        var _boxeverq = _boxeverq || [];

        // Define the Boxever settings
        var _boxever_settings = {
            client_key: '@SitecoreCDP.Project.Website.Constants.client_key',
            // Replace with your client key
            target: '@SitecoreCDP.Project.Website.Constants.targetEndPoint',
            // Replace with your API target endpoint specific to your data center region
            cookie_domain: '@SitecoreCDP.Project.Website.Constants.cookieDomain',
            // Replace with the top level cookie domain of the website that is being integrated
            javascriptLibraryVersion: '@SitecoreCDP.Project.Website.Constants.javascriptLibraryVersion',
            // Replace with the latest Boxever JavaScript Library version
            pointOfSale: '@SitecoreCDP.Project.Website.Constants.pointOfSale',
            // Replace with the same point of sale configured in system settings
            web_flow_target: 'https://d35vb5cccm4xzp.cloudfront.net',
            // Replace with path for the Amazon CloudFront CDN for Sitecore Personalize
            web_flow_config: { async: false, defer: false }
            // Customize the async and defer script loading attributes
        };
        // Import the Boxever JavaScript Library asynchronously
        (
            function () {
                var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
                s.src = '@("https://d1mj578wat5n4o.cloudfront.net/boxever-" + SitecoreCDP.Project.Website.Constants.javascriptLibraryVersion + ".min.js")';
                var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);
            }
        )();
    </script>
</head>

<body>
    <div>
        @Html.Sitecore().Placeholder("cdp-main")
    </div>
    <script src="~/Scripts/jquery.js"></script>
    <script src="~/Scripts/bootstrap.js"></script>
    <script src="~/Scripts/jquery.stellar.min.js"></script>
    <script src="~/Scripts/owl.carousel.min.js"></script>
    <script src="~/Scripts/smoothscroll.js"></script>
    <script src="~/Scripts/custom.js"></script>
    <script type="text/javascript">
        // Get Browser ID
        $(document).ready(
            function () {
                $("#btnBrowserID").click(
                    function () {
                        alert(Boxever.getID());
                    }
                );
            }
        );

        // Send Default Identity
        $(document).ready(
            function () {
                $("#btnDefaultIdentity").click(
                    function () {
                        sendDefaultIdentity();
                    }
                );
            }
        );
        // Follow Documentation --> doc.sitecore.com/cdp/en/developers/sitecore-customer-data-platform--data-model-2-1/send-an-identity-event-to-sitecore-cdp.html
        function sendDefaultIdentity() {
            var sentIdentity = {
                "channel": "WEB",
                "type": "IDENTITY",
                "language": "EN",
                "currency": "USD",
                "page": "/BasicLearning/CDPLearning",
                "pos": window._boxever_settings.pointOfSale,
                "browser_id": Boxever.getID(),
                "email": "chirag.goel@fakegmail.com",
                "title": "Mr.",
                "firstname": "Chirag",
                "lastname": "Goel",
                "gender": "male",
                "identifiers": [
                    {
                        "provider": "MainEmail",
                        "id": "123456"
                    }
                ]
            }
            Boxever.eventCreate(sentIdentity, function (data) { }, 'json');
            alert("Identified Guest with Default Values");
        }

        // Get Guest ID
        $(document).ready(
            function () {
                $("#btnGuestID").click(
                    function () {
                        getGuestID();
                    }
                );
            }
        );
        // Follow Documentation --> sitecore.cdpknowledgehub.com/docs/web-tagging-javascript-library-functions
        function getGuestID() {
            Boxever.browserShow(Boxever.getID(), 0, function (response) {
                var guestRefID = response.customer.ref;
                alert(guestRefID);
            }, 'json');
        }
    </script>
</body>
</html>